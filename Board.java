import java.util.Random;

public class Board {
  private char[][] board;
  private Agent[] agents;

  public Board(float[][] probs) {
    int n = probs.length;
    this.board = new char[][] {
      {'O','O','O','O','O','O',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','O','O','O','O','O','O'},
      {'O',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','O'},
      {'O',' ',' ','O','O',' ',' ',' ','O','O',' ','O','O','O',' ','O','O',' ',' ',' ','O','O',' ',' ','O'},
      {'O',' ','O','O','O',' ',' ',' ',' ','$',' ',' ',' ',' ',' ',' ',' ',' ',' ','$','O','O','O',' ','O'},
      {'O',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','$',' ',' ',' ','O'},
      {' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '},
      {' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '},
      {' ',' ','O','O',' ',' ',' ',' ','O','O','O','O','F','O','O','O','O',' ',' ',' ',' ','O','O',' ',' '},
      {' ',' ','O','O',' ',' ',' ',' ','O','O','O',' ',' ',' ','O','O','O',' ',' ',' ',' ','O','O',' ',' '},
      {' ',' ',' ',' ',' ',' ',' ',' ','O','O',' ',' ',' ',' ','$','O','O','$',' ',' ',' ',' ','$',' ',' '},
      {'$',' ','O','O',' ',' ',' ',' ','O',' ',' ',' ',' ',' ',' ',' ','O',' ',' ',' ',' ','O','O',' ',' '},
      {' ',' ','O',' ',' ',' ',' ',' ',' ',' ',' ',' ','O',' ',' ',' ',' ',' ',' ',' ',' ',' ','O',' ',' '},
      {'$',' ','O','O',' ',' ',' ',' ','O',' ',' ',' ',' ',' ','$',' ','O',' ',' ',' ',' ','O','O',' ',' '},
      {' ',' ','$',' ','$',' ',' ',' ','O','O',' ',' ','$',' ',' ','O','O',' ',' ',' ',' ',' ',' ',' ',' '},
      {' ',' ','O','O',' ',' ',' ',' ','O','O','O',' ',' ',' ','O','O','O',' ',' ',' ',' ','O','O',' ',' '},
      {' ',' ','O','O',' ',' ',' ',' ','O','O','O','O',' ','O','O','O','O',' ',' ',' ',' ','O','O',' ',' '},
      {' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '},
      {' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '},
      {' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '},
      {'O',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','O'},
      {'O',' ','O','O','O','$',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','O','O','O',' ','O'},
      {'O',' ','O','O','O',' ',' ',' ','O','O',' ','O',' ','O',' ','O','O',' ',' ',' ','O','O','O',' ','O'},
      {'O',' ',' ','O','O',' ',' ',' ','O','O',' ','O','O','O',' ','O','O',' ',' ',' ','O','O',' ',' ','O'},
      {'O','$',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','$','$','O'},
      {'O','O','O','O','O','O',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','O','O','O','O','O','O'}
    };
    this.agents = new Agent[n];
    Random rand = new Random();
    for (int i = 0; i < n; i++) {
      int x = rand.nextInt(26);
      int y = rand.nextInt(26);
      while (board[x][y] != 'O' && board[x][y] != 'F') {
        x = rand.nextInt(26);
        y = rand.nextInt(26);
      }
      this.agents[i] = new Agent(i, x, y, probs[i]);
      this.board[x][y] = 'I';
    }
  }

  public void move_agents() {
      for (Agent agent : this.agents) {
          boolean food = false;
          int[] og_pos = agent.getPos();
          int[] pos = agent.move();
          if (this.board[pos[0]][pos[1]] == '$') {
              food = true;
          }   if (this.board[pos[0]][pos[1]] == 'O' || this.board[pos[0]][pos[1]] == 'I') {
              agent.revert();
          }
          if (this.board[pos[0]][pos[1]] == 'F') {
            agent.finish();
          } else {
            this.board[pos[0]][pos[1]] = 'I';
          }
          this.board[og_pos[0]][og_pos[1]] = ' ';
          if (food) {
              agent.addRvalue(5);
          }
      }
  }

  public boolean finished() {
    for (Agent agent : this.agents) {
      int[] pos = agent.getPos();
      if (!(this.board[pos[0]][pos[1]] == 'F')) {
          return false;
      }
    }
    return true;
  }
}
